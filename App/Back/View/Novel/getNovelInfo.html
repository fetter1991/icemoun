<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
<head>
    <title>导入小说</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <meta content="" name="description"/>
    <meta content="" name="author"/>
    <meta name="renderer" content="webkit"/>
    <link href="__MC__/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
    <link href="__MC__/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css"/>
    <link href="__MC__/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
    <link href="__MC__/global/plugins/uniform/css/uniform.default.css" rel="stylesheet" type="text/css"/>
    <link href="__MC__/global/plugins/bootstrap-switch/css/bootstrap-switch.min.css" rel="stylesheet" type="text/css"/>
    <link href="__MC__/global/css/components.min.css" rel="stylesheet" id="style_components" type="text/css"/>
    <link href="__MC__/global/css/plugins.min.css" rel="stylesheet" type="text/css"/>
    <link href="__MC__/layouts/layout/css/layout.min.css" rel="stylesheet" type="text/css"/>
    <link href="__MC__/layouts/layout/css/custom.min.css" rel="stylesheet" type="text/css"/>
    <link href="__MC__/global/plugins/bootstrap-toastr/toastr.min.css" rel="stylesheet" type="text/css"/>
    <link href="__MC__/global/plugins/bootstrap-modal/css/bootstrap-modal-bs3patch.css" rel="stylesheet"
          type="text/css"/>
    <link href="__MC__/global/plugins/bootstrap-modal/css/bootstrap-modal.css" rel="stylesheet" type="text/css"/>
    <style>
        .form-body {
            padding-top: 10px !important;
        }

        .formgroup {
            width: 33%;
            display: inline-block;
            margin-bottom: 8px;
        }

        .formgroup1 {
            width: 45%;
            display: inline-block;
            margin-bottom: 8px;
        }

        .caption {
            padding: 10px 0;
            border-bottom: 1px solid #eef1f5;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .tableTr {
            width: 49.5%;
            display: inline-block;
            vertical-align: inherit;
            border-color: inherit;
            border-collapse: collapse;
            border-spacing: 0;
            margin-top: -5px;
            margin-left: -1px;
        }

        .tableTd {
            border: 1px solid #e7ecf1;
            padding: 8px;
            line-height: 1.42857;
            vertical-align: top;
            display: table-cell;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="row" style="margin-top: 15px;">
        <div class="col-xs-12">
            <div class="portlet light portlet-fit portlet-form bordered">
                <div class="portlet-body">
                    <div class="form-body">
                        <if condition="$info['name']">
                            <div class="form-group form-md-radios">
                                <form class="" action="{:U('Novel/add')}" method="post" id="NovelAdd"
                                      enctype="multipart/form-data">
                                    <div class="form-body">
                                        <div class="caption">
                                            <span class="caption-subject font-dark sbold uppercase">小说信息</span>
                                        </div>

                                        <!--小说名称-->
                                        <div class="form-group formgroup">
                                            <label class="col-md-4 control-label">小说名称</label>
                                            <div class="col-md-8">
                                                <input type="text" class="form-control" name="name" id="name"
                                                       placeholder="影片名" value="{$info.name}" readonly/>
                                            </div>
                                        </div>
                                        <!--作者名称-->
                                        <div class="form-group formgroup">
                                            <label class="col-md-4 control-label">作者名称</label>
                                            <div class="col-md-8">
                                                <input type="text" class="form-control" name="author" id="author"
                                                       placeholder="作者名称" value="{$info.author}" readonly/>
                                            </div>
                                        </div>
                                        <!--标签-->
                                        <div class="form-group formgroup">
                                            <label class="col-md-4 control-label">标签</label>
                                            <div class="col-md-8">
                                                <input type="text" class="form-control" name="tags" id="tags"
                                                       placeholder="填写时以‘|’分隔" value="{$info.tags}" required/>
                                            </div>
                                        </div>
                                        <!--付费章节-->
                                        <div class="form-group formgroup">
                                            <label class="col-md-4 control-label">付费章节</label>
                                            <div class="col-md-8">
                                                <input type="text" class="form-control" name="begin_pay" id="begin_pay"
                                                       placeholder="付费章节" value="{$info.begin_pay}" required/>
                                            </div>
                                        </div>
                                        <!--价格-->
                                        <div class="form-group formgroup">
                                            <label class="col-md-4 control-label">价格</label>
                                            <div class="col-md-8">
                                                <input type="text" class="form-control" name="price" id="price"
                                                       placeholder="价格" value="{$info.price}" required/>
                                            </div>
                                        </div>
                                        <!--适合人群-->
                                        <div class="form-group formgroup">
                                            <label class="col-md-4 control-label">适合人群</label>
                                            <div class="col-md-8">
                                                <input type="text" class="form-control" name="sex" id="sex"
                                                       placeholder="适合人群" value="{$info.sex}" required/>
                                            </div>
                                        </div>
                                        <!--小说名称-->
                                        <div class="form-group formgroup">
                                            <label class="col-md-9 control-label">原始ID：{$apiId}
                                                <span id="checkSort" data-id="{$apiId}">
                                                    <i class="glyphicon glyphicon-refresh"
                                                       style="color: rgb(255, 0, 0); margin-left: 4px; font-size: 12px;"></i>
                                                    检测排序
                                                </span>
                                                <input type="hidden" id="errCode" value="">
                                            </label>
                                        </div>
                                        <!--简介-->
                                        <div class="form-group showInput" style="display: none">
                                            <label class="col-md-3 control-label">简介</label>
                                            <div class="col-md-8">
                                            <textarea name="desc" id="description" class="form-control is_empty"
                                                      rows="5" required>{$info.desc}</textarea>
                                            </div>
                                        </div>
                                        <if condition='!empty($list)'>
                                            <div class="caption">
                                                <span class="caption-subject font-dark sbold uppercase">章节列表</span>
                                            </div>
                                            <div class="tableTr">
                                                <span class="tableTd" style="width: 44%;font-weight: bold;">标题</span>
                                                <span class="tableTd" style="width: 5%;font-weight: bold;">排序</span>
                                            </div>
                                            <div class="tableTr" style="margin-left: -5px;">
                                                <span class="tableTd" style="width: 44%;font-weight: bold;">标题</span>
                                                <span class="tableTd" style="width: 5%;font-weight: bold;">排序</span>
                                            </div>
                                            <volist name="list" id="vo">
                                                <div class="tableTr">
                                                    <span class="tableTd" style="width: 44%">{$vo.title}</span>
                                                    <span class="tableTd" style="width: 5%;text-align: center">{$vo.sort}</span>
                                                </div>
                                            </volist>
                                            </table>
                                            <else/>
                                            <strong>获取章节列表信息失败。</strong>
                                        </if>
                                    </div>
                                </form>
                            </div>
                            <div class="col-xs-12" style="padding:0 0 5px 0;color: #f00;">注：点击确定导入书本信息</div>
                            <else/>
                            <div class="col-xs-12" style="padding:0 0 5px 0;color: #f00;">{$msg}</div>
                        </if>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<script src="__MC__/global/plugins/jquery.min.js" type="text/javascript"></script>
<script src="__JS__/layer/2.4/layer.js"></script>
<script>
    var callbackdata = function () {
        var form = $("#NovelAdd").serialize();
        var name = $("#name").val();
        var author = $("#author").val();
        var tags = $("#tags").val();
        var begin_pay = $("#begin_pay").val();
        var price = $("#price").val();
        var sex = $("#sex").val();
        var desc = $("#description").val();
        var errCode = $("#errCode").val();
        var data = {
            form: form,
            name: name,
            author: author,
            tags: tags,
            begin_pay: begin_pay,
            price: price,
            sex: sex,
            desc: desc,
            errCode: errCode
        };
        return data;
    }

    $('#checkSort').on('click', function () {
        var id = $('#checkSort').data('id')
        $.post('/Back/Novel/checkSort', {id: id}, function (res) {
            layer.alert(res.msg)
            $('#errCode').val(res.code);
        });
    });
</script>
</html>
